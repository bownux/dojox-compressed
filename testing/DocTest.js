//>>built
define("dojox/testing/DocTest",["dojo/string"],function(){dojo.declare("dojox.testing.DocTest",null,{errors:[],getTests:function(a){a=dojo.moduleUrl(a).path;a=a.substring(0,a.length-1)+".js";dojo.xhrGet({url:a,handleAs:"text"});return this._getTestsFromString(dojo._getText(a),!0)},getTestsFromString:function(a){return this._getTestsFromString(a,!1)},_getTestsFromString:function(a,b){for(var d=dojo.hitch(dojo.string,"trim"),g=a.split("\n"),h=g.length,i=[],f=[],e=[],j=null,k=0;k<h+1;k++){var c=d(g[k]||
"");b&&c.match(/^\/\/\s+>>>\s.*/)||c.match(/^\s*>>>\s.*/)?(j||(j=k+1),0<e.length&&(i.push({commands:f,expectedResult:e.join("\n"),line:j}),f=[],e=[],j=k+1),c=b?d(c).substring(2,c.length):c,c=d(c).substring(3,c.length),f.push(d(c))):(!b||c.match(/^\/\/\s+.*/))&&f.length&&0==e.length?(c=b?d(c).substring(3,c.length):c,e.push(d(c))):0<f.length&&e.length&&((!b||c.match(/^\/\/\s*$/))&&i.push({commands:f,expectedResult:e.join("\n"),line:j}),b&&!c.match(/^\/\//)&&i.push({commands:f,expectedResult:e.join("\n"),
line:j}),f=[],e=[],j=0)}return i},run:function(a){this.errors=[];(a=this.getTests(a))&&this._run(a)},_run:function(a){var b=a.length;this.tests=b;for(var d=0,g=0;g<b;g++){var h=a[g],i=this.runTest(h.commands,h.expectedResult),f="Test "+(g+1)+": ",e=h.commands.join(" "),e=50<e.length?e.substr(0,50)+"...":e;i.success?(console.info(f+"OK: "+e),d+=1):(this.errors.push({commands:h.commands,actual:i.actualResult,expected:h.expectedResult}),console.error(f+"Failed: "+e,{commands:h.commands,actualResult:i.actualResult,
expectedResult:h.expectedResult}))}console.info(b+" tests ran.",d+" Success,",this.errors.length+" Errors")},runTest:function(a,b){var d={success:!1,actualResult:null},g=a.join("\n");d.actualResult=eval(g);if(""+d.actualResult==b||dojo.toJson(d.actualResult)==b||'"'==b.charAt(0)&&'"'==b.charAt(b.length-1)&&""+d.actualResult==b.substring(1,b.length-1))d.success=!0;return d}});return dojox.testing.DocTest});